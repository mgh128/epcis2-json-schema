{
  "$id": "https://id.gs1.org/epcis-schema.json",
  "type": "object",
  "definitions": {
    "uri": {
      "type": "string",
      "format": "uri"
    },
    "time": {
      "type": "string",
      "format": "date-time"
    },
    "decimal": {
      "type":  "number"
    },
    "epcClass": {
      "type": "string",
      "format":  "uri",
      "pattern": "^urn:epc:.*$"
    },
    "uom": {
      "type": "string",
      "pattern": "^[A-Z0-9]{2,3}$"
    },
    "eventId": {
      "type": "string",
      "format": "uri",
      "pattern": "^urn:uuid:[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
    },
    "quantityElement": {
      "type": "object",
      "properties": {
        "epcClass": { "$ref": "#/definitions/epcClass" },
        "quantity": { "$ref": "#/definitions/decimal" },
        "uom": { "$ref": "#/definitions/uom" }
      },
      "required": [ "epcClass" ]
    },
    "bizTransaction": {
      "type": "object",
      "properties": {
        "type": { "$ref": "#/definitions/uri" },
        "bizTransaction": { "$ref": "#/definitions/uri" }
      },
      "required": [ "bizTransaction" ]
    },
    "errorDeclaration": {
      "type": "object",
      "properties": {
        "declarationtime": { "$ref": "#/definitions/time" },
        "reason": { "$ref": "#/definitions/uri" },
        "correctiveeventIds": {
          "type": "array",
          "items": { "$ref": "#/definitions/eventId" }
        }
      }
    },

    "epc": { "$ref": "#/definitions/uri" },
    "action": {
      "type": "string",
      "enum": [
        "OBSERVE",
        "ADD",
        "DELETE"
      ]
    },
    "epcList": {
      "type": "array",
      "items": { "$ref": "#/definitions/epc" }
    },
    "event": {
      "type": "object",
      "properties": {
        "eventtime": {
          "title": "Event time",
          "description": "time of when the Event took place.",
          "$ref": "#/definitions/time"
        },
        "recordtime": {
          "title": "Record time",
          "description": "time of when the Event was stored.",
          "$ref": "#/definitions/time" 
        },
        "eventtimeZoneOffset": {
          "type": "string",
          "pattern": "^(\\+|\\-)((0[0-9]|1[0-3]):([0-5][0-9])|14:00)$"
        },
        "eventId": { "$ref": "#/definitions/eventId" }
      }
    },
    "objectEvent": {
      "allOf": [
        {
          "$ref": "#/definitions/event"
        },
        {
          "type": "object",
          "properties": {
            "isA": {
              "type": "string",
              "pattern": "^ObjectEvent$"
            },
            "epcList": { "$ref": "#/definitions/epcList" },
            "quantityList": {
              "type": "array",
              "items": { "$ref": "#/definitions/quantityElement" }
            },
            "action": { "$ref": "#/definitions/action" },
            "bizStep": { "$ref": "#/definitions/uri" },
            "disposition": { "$ref": "#/definitions/uri" },
            "readPoint": { "$ref": "#/definitions/uri" },
            "bizLocation": { "$ref": "#/definitions/uri" },
            "bizTransactionList": {
              "type": "array",
              "items": { "$ref": "#/definitions/bizTransaction" }
            }
          }
        }
      ]
    },
    "aggregationEvent": {
      "allOf": [
        {
          "$ref": "#/definitions/event"
        },
        {
          "type": "object",
          "properties": {
            "isA": {
              "type": "string",
              "pattern": "^AggregationEvent$"
            },
            "parentID": { "$ref": "#/definitions/uri" },
            "childEPCs": { "$ref": "#/definitions/epcList" },
            "action": { "$ref": "#/definitions/action" },
            "bizStep": { "$ref": "#/definitions/uri" },
            "disposition": { "$ref": "#/definitions/uri" },
            "readPoint": { "$ref": "#/definitions/uri" },
            "bizLocation": { "$ref": "#/definitions/uri" }
          }
        }
      ]
    }
  },
  "properties": {
    "@context": {
      "type": "string"
    },
    "isA": {
      "type": "string"
    },
    "schemaVersion": {
      "title": "Schema Version",
      "description": "The version of the EPCIS Schema being used.",
      "type": "string"
    },
    "creationDate": {
      "type": "string",
      "format": "date-time"
    },
    "format": {
      "type": "string"
    },
    "epcisBody": {
      "type": "object",
      "properties": {
        "eventList": {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "$ref": "#/definitions/objectEvent"
              },
              {
                "$ref": "#/definitions/aggregationEvent"
              }
            ]
          }
        }
      }
    }
  }
}